# 简介

腾讯云消息队列（Cloud Message Queue，CMQ）是一种分布式消息队列服务，它能够提供可靠的基于消息的异步通信机制，能够将分布式部署的不同应用（或同一应用的不同组件）之间的收发消息，存储在可靠有效的 CMQ 队列中，防止消息丢失。CMQ 支持多进程同时读写，收发互不干扰，无需各应用或组件始终处于运行状态。

- 高性能，消息队列 CMQ 高效支持**亿级消息收发和推送**，**海量消息堆积且消息堆积容量不设上限**；CMQ 吞吐量巨大，**单集群 QPS 超过 10 万**，满足您的业务之间的消息收发需求。
- 高可用，CMQ 在每条消息返回到用户时，将消息数据备份 3 份写到不同物理机上，当某台物理机出故障时，后台数据复制机制能够对数据快速迁移，保证用户数据3 个备份可用，可靠保证达 99.999999%，业务连续可用性99.95%承诺，引入 **Raft 算法实现数据强一致性**。
- 横向扩展，底层系统根据业务规模，自动弹性扩展消息队列的队列数量和队列存储容量，对上层业务无感知，提供北京、上海、广州等多地域服务。平滑水平扩展，单集群提供超 10 万 QPS，逻辑上**单个队列服务可跨多个集群**提供服务。
- 安全可靠，CMQ 支持 HTTPS 安全访问连接，并基于腾讯云平台多维度的安全防护，抵御网络攻击，保护您的业务隐私。同时支持主子账号，协作者账号等账号管理，支持基于细粒度资源访问控制权限，细化管理。
- 易用免运维，提供 API 访问接口和 java，C++ 等多种 SDK，简化开发成本，方便上云。支持多维度的监控告警功能，无须关心底层资源的运维，专注您的业务开发。

# 产品详细信息

腾讯云消息队列（Cloud Message Queue，CMQ）提供了可靠的基于消息的异步通信服务，能够将分布式部署的不同应用（或同一应用的不同组件）之间的收发消息，存储在安全可靠的 CMQ 队列中，防止消息丢失，支持多进程同时读写，收发互不干扰，无需各应用或组件始终处于运行状态。

您可以使用控制台或命令行，SDK 等多种管理工具来启动、监控或终止您的消息队列。

腾讯云消息队列的收费费用包括请求次数费用、消息堆积费用和出流量费用。目前请求次数费用和消息堆积费用暂不收取，出流量费用按地域分别收取，采取按量计费的模式，每小时进行一次结算，您可以随时开通或销毁您的消息队列。

## 功能

腾讯云消息队列提供可靠的异步通信机制，致力于支持用户业务异步的消息服务。

### 异步通信协议

消息的发送者将消息发送到消息队列后可以立即返回，不用等待接收者的响应。消息会被保存在队列中，直到被接收者取出。消息的发送与处理是完全异步的。

### 提高可靠性

传统模式下消息可能因为长时间等待而导致请求失败。消息队列模式下，如果发送消息时接收者不可用，消息队列会保留消息直到成功传递它。

### 进程解耦

消息队列帮助减少两个进程间的耦合度。只要消息格式不变，即使接收者的接口、位置或者配置改变，也不会给发送者带来任何改变。并且，消息发送者无需知道消息接收者是谁，使得系统设计更清晰；相反的，进程间使用远程过程调用（RPC）或者socket连接，当一方接口、ip或端口改变了，另一方则必须修改请求配置。

### 消息路由

发送者无需与接收者建立直接连接，双方通过消息队列保证消息能够从发送者路由到接收者，甚至对于本来网络不易互通的两个服务，也可以提供消息路由。

### 多终端

用户的多个业务终端之间可以同时发送或接收消息，腾讯云 CMQ 通过消息状态来进行消息可用性的控制。

### 多样性

**每个队列均可独立配置，并非所有队列都要完全相同。在不同业务场景下的队列可以进行个性化的配置，例如一个队列中消息处理时间较长，可以针对队列属性进行优化。**

> 备注：
>
> 这个特性不错，借此可以轻松实现不同高低优先级的队列逻辑了！

# 消息模型

腾讯云消息队列 CMQ  提供了不同的消息模型来满足用户特定的使用场景，这些消息模型由不同的推送方式和特定功能组成不同的组合。

腾讯云消息队列 CMQ 提供了两种消息模型：消息队列模型（Queue 模型）和消息主题模型（Topic 模型）。您可以根据不同的服务场景和所需的功能选择合适的消息模型。

## 消息队列模型

### 消息推拉模式：PULL 模式

### 功能

#### 丰富的队列属性

CMQ 提供了丰富的队列属性配置选项，包括消息生命周期，消息大小，消息隐藏时间，消息接收长轮询等待时间等参数，您可以根据您业务需求，设置合理的参数。

#### 消息回溯功能

CMQ 可以开启消息回溯功能并设定时间点和时间范围，在回溯时间范围内，您可以重新消费您已经成功消费且删除的消息数据，方便您的业务回溯审计。详情请见：[消息回溯](https://cloud.tencent.com/document/product/406/8129)

#### 消息并发发送及接收

支持批量并发发送和接收消息，提升业务的吞吐性能。

#### 消息投递保障

在消息有效期内，确保消息至少能被成功消费一次。用户间资源隔离，确保您队列中的消息不会被非法获取。

#### 延时消息功能

队列模式下，任何发往 CMQ 的消息都可以设定为延时消息，延时消息到达消息代理节点后，在延时时间范围内，消息为不可见状态，在该状态下，消费者无法看到该消息。超过延时时间后，消费者才可以看见并消费该消息。延时消息可以模拟定时消息来使用。详情请见：[延时消息](https://cloud.tencent.com/document/product/406/8128)

## 消息主题模型

### 消息推拉模式：PUSH 模式

### 功能

#### 一对多消息投递

一条通知消息可以同时被多个订阅者订阅和消费，支持将某 Queue 设为订阅者。

#### 多种投递方式

支持将消息投递到用户指定的 URL 地址和 queue 消息队列中。您可以根据您的业务需求灵活选择

#### 消息过滤

支持消息 Tag 和消息路由键两种消息过滤方式，消费端可以通过匹配标签选择性的进行消费。详情请见：[标签匹配](https://cloud.tencent.com/document/product/406/6906)、[路由键匹配](https://cloud.tencent.com/document/product/406/8127)

#### 消息投递保障

在消息有效期内，保证发布到 Topic 中的消息会按照指定的重试策略，进行多次重试投递，尽可能保证业务成功接收消息。

#### 丰富的主题属性

CMQ 提供了丰富的主题属性配置选项，包括消息生命周期，消息大小，消息过滤类型等参数，您可以根据您业务需求，设置合理的参数。

# 定价

腾讯云消息队列 CMQ 的费用包括：请求次数费用、消息堆积费用和出流量费用。其中请求次数费用和消息堆积费用暂不收取，您可以免费使用。如果往后需要收费，我们会在正式收费前以邮件、电话、短信等方式通知您，请您放心使用。出流量费用按地域分别收取，采取按量计费的模式，每小时进行一次结算。